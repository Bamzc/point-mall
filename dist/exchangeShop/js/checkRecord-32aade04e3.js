define(["util","template","text!js/module/exchangeShop/checkRecord/checkRecord.art","common","store"],function(e,o,n,c,t){function u(e,o){$.ajax({url:"/point-mall/data/checkRecord.json",type:"get",dataType:"json",data:{pageNumber:o&&o.pageNumber||1,pageSize:o&&o.pageSize||20},success:function(o){o.success?(o.data.imgbaseurl=o.imgbaseurl,e(o.data)):mui.alert(o.message)},error:function(){mui.alert("请求失败")}})}function r(){l.initRefresh()}var l={initRefresh:function(){var e=this;this.options={pageNumber:1},mui("#checkRecord").pullRefresh({down:{height:50,auto:!0,contentdown:"下拉可以刷新",contentover:"释放立即刷新",contentrefresh:"正在刷新...",callback:e.pulldownRefresh},up:{height:50,auto:!1,contentrefresh:"正在加载...",contentnomore:"没有更多数据了",callback:e.pullupRefresh}}),mui.os.plus?mui.plusReady(function(){setTimeout(function(){mui("#checkRecord").pullRefresh().pullupLoading()},1e3)}):mui.ready(function(){mui("#checkRecord").pullRefresh().pullupLoading()})},pulldownRefresh:function(){l.options.pageNumber=1,u(function(e){if(""==e)mui("#checkRecord").pullRefresh().endPulldownToRefresh();else{var c=o.render(n,e);$("#checkRecord").find(".ck-list").html(c),mui("#checkRecord").pullRefresh().endPulldownToRefresh(),mui("#checkRecord").pullRefresh().refresh(!0)}},l.options)},pullupRefresh:function(){l.options.pageNumber++,console.log(1),u(function(e){console.log(e.lastPage==e.pageNum),mui("#checkRecord").pullRefresh().endPullupToRefresh(e.lastPage==e.pageNum);var c=o.render(n,e);$("#checkRecord").find(".ck-list").append(c)},l.options)}};return{render:function(){var o=this;e.requestHtml("/exchangeShop/checkRecord.html",function(e){$(document).prop("title","验证记录"),$("#pointsMall").html(e),o.loadDidView()})},loadDidView:r}});